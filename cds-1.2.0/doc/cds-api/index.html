<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>cds: CDS: Concurrent Data Structures library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">cds
   &#160;<span id="projectnumber">1.2.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">CDS: Concurrent Data Structures library </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This library is a collection of lock-free and lock-based fine-grained algorithms of data structures like maps, queues, list etc. The library contains implementation of well-known data structures and memory reclamation schemas for modern processor architectures.</p>
<p>Supported processor architectures and operating systems (OS) are:</p>
<ul>
<li>x86 [32bit] linux, windows, freeBSD</li>
<li>amd64 (x86-64) [64bit] linux, windows, freeBSD</li>
<li>ia64 (itanium) [64bit] linux, HP-UX 11.23, HP-UX 11.31</li>
<li>sparc [64bit] sun solaris</li>
</ul>
<p>Supported compilers:</p>
<ul>
<li>GCC 4.3+ - for the UNIX-like OSes</li>
<li>Clang 3.0+ - for Linux</li>
<li>MS Visual C++ 2008 and above - for MS Windows</li>
</ul>
<p>For each lock-free data structure the <code>CDS</code> library presents several implementation based on published papers. For example, there are several implementations of queue, each of them is divided by memory reclamation schema used. However, any implementation supports common interface for the type of data structure.</p>
<p>To implement any lock-free data structure, two things are needed:</p>
<ul>
<li>atomic operation library conforming with C++11 memory model. The <b>libcds</b> has such feature, see <a class="el" href="namespacecds_1_1cxx11__atomics.html" title="C++11 Atomic library support.">cds::cxx11_atomics</a> namespace for details and compiler-specific information.</li>
<li>safe memory reclamation (SMR) or garbage collecting (GC) algorithm. The <b>libcds</b> has an implementation of several well-known SMR algos, see below.</li>
</ul>
<p>The main part of lock-free data structs is garbage collecting. The garbage collector (GC) solves the problem of safe memory reclamation that is one of the main problems for lock-free programming. The library contains the implementations of several light-weight <a class="el" href="group__cds__garbage__collector.html">memory reclamation schemes</a>:</p>
<ul>
<li>M.Michael's Hazard Pointer - see <a class="el" href="classcds_1_1gc_1_1_h_p.html" title="Hazard Pointer garbage collector.">cds::gc::HP</a> for more explanation</li>
<li>Gidenstam's memory reclamation schema based on Hazard Pointer and reference counting - see <a class="el" href="classcds_1_1gc_1_1_h_r_c.html" title="Gidenstam&#39;s garbage collector.">cds::gc::HRC</a></li>
<li>M.Herlihy and M.Moir's Pass The Buck algorithm - see <a class="el" href="classcds_1_1gc_1_1_p_t_b.html" title="Pass-the-Buck garbage collector.">cds::gc::PTB</a></li>
<li>there is <a class="el" href="classcds_1_1gc_1_1nogc.html" title="No garbage collecting.">cds::gc::nogc</a> "GC" for containers that do not support item reclamation.</li>
</ul>
<p>Many GC requires a support from the thread. The library does not define the threading model you must use, it is developed to support various ones; about incorporating <b>cds</b> library to your threading model see <a class="el" href="namespacecds_1_1threading.html" title="Threading support.">cds::threading</a>.</p>
<p>The main namespace for the library is <a class="el" href="namespacecds.html">cds</a></p>
<dl class="section user"><dt>How to build</dt><dd></dd></dl>
<p>The <b>cds</b> is mostly header-only library. Only small part of library related to GC core functionality must be compiled. The test projects depends on the following static library from <code>boost:</code> </p>
<ul>
<li><code>boost_thread</code></li>
<li><code>boost_date_time</code></li>
</ul>
<dl class="section user"><dt>Windows build</dt><dd></dd></dl>
<p>Prerequisites: for building <b>cds</b> library and test suite you need:</p>
<ul>
<li><a href="http://www.activestate.com/activeperl/downloads">perl</a> installed; <code>PATH</code> environment variable should contain full path to Perl binary. Perl is used to generate large dictionary for testing purpose;</li>
<li><a href="http://www.boost.org/">boost library</a> 1.39 and above. You should create environment variable <code>BOOST_PATH</code> containing full path to <code>boost</code> root directory (for example, <code>C:\libs\boost_1_47_0</code>).</li>
</ul>
<p>Open solution file <code>cds\projects\vcX\cds.sln</code> where vcX - version of Microsoft Visual C++ you use: vc9 for MS VC 2008, vc10 for MS VC 2010 and so on. The solution contains <code>cds</code> project and several test projects. Just build the library using solution.</p>
<p><b>Warning</b>: the solution depends on <code>BOOST_PATH</code> environment variable that specifies full path to <code>boost</code> library root directory. The test projects search <code>boost</code> libraries in:</p>
<ul>
<li>for 32bit: $(BOOST_PATH)/stage/lib, $(BOOST_PATH)/stage32/lib, and $(BOOST_PATH)/bin.</li>
<li>for 64bit: $(BOOST_PATH)/stage64/lib and $(BOOST_PATH)/bin.</li>
</ul>
<dl class="section user"><dt>*NIX build</dt><dd></dd></dl>
<p>For Unix-like systems GCC and Clang compilers are supported. Use GCC 4.3 (or above) compiler or Clang 3.0 or above to build <b>cds</b> library. The distributive contains makefile and <code>build.sh</code> script in <code>build</code> directory. The <code>build/sample</code> directory contains sample scripts for different operating systems and processor architectures. The <code>build.sh</code> script supports the following options:</p>
<ul>
<li><code>-c toolset</code> - Toolset name, possible values: <code>gcc</code> (default), <code>clang</code></li>
<li><code>-x compiler</code> - C++ compiler name (e.g. g++, g++-4.5 and so on)</li>
<li><code>-p arch</code> - processor architecture; possible values for arch are: x86, amd64 (x86_64), sparc, ia64</li>
<li><code>-o OStype</code> - OS family; possible values for OStype are: linux, sunos (solaris), hpux</li>
<li><code>-D define</code> additional defines</li>
<li><code>-b bits</code> - bits to build, accepts '64', '32'</li>
<li><code>-l "options"</code> - extra linker options (in quotes)</li>
<li><code>-z "options"</code> - extra compiler options (in quotes)</li>
<li><code>&ndash;with-boost path</code> - path to boost include</li>
<li><code>&ndash;debug-cxx-options "options"</code> - extra compiler options for debug target</li>
<li><code>&ndash;debug-ld-options "options"</code> - extra linker options for debug target</li>
<li><code>&ndash;release-cxx-options "options"</code> - extra compiler options for release target</li>
<li><code>&ndash;release-ld-options "optons"</code> - extra linker options for release target</li>
<li><code>&ndash;clean</code> - clean all before building</li>
<li><code>&ndash;debug-test</code> - make unit test in debug mode; by defalt release unit test generated</li>
<li><p class="startli"><code>&ndash;amd64-use-128bit</code> - compile with supporting 128bit (16byte) CAS on amd64 (for am64 only)</p>
<p class="startli"><b>Important for GCC compiler</b>: all your projects that use <b>libcds</b> must be compiled with <b>-fno-strict-aliasing</b> compiler flag. Also, the compiler option <code>-std=c++0x</code> is very useful.</p>
</li>
</ul>
<p><a class="anchor" id="cds_how_to_use"></a></p>
<dl class="section user"><dt>How to use</dt><dd></dd></dl>
<p>To use <code>cds</code> lock-free containers based on garbage collectors (GC) provided by library your application must be linked with <code>libcds</code>.</p>
<p>The main part of lock-free programming is garbage collecting for safe memory reclamation. The library provides several types of GC schemes. One of widely used and well-tested one is Hazard Pointer memory reclamation schema discovered by M. Micheal and implemented in the library as <a class="el" href="classcds_1_1gc_1_1_h_p.html" title="Hazard Pointer garbage collector.">cds::gc::HP</a> class. Usually, the application is based on only one type of GC.</p>
<p>In the next example we mean that your application uses Hazard Pointer (<a class="el" href="classcds_1_1gc_1_1_h_p.html" title="Hazard Pointer garbage collector.">cds::gc::HP</a>) - based containers. Other GCs (<a class="el" href="classcds_1_1gc_1_1_h_r_c.html" title="Gidenstam&#39;s garbage collector.">cds::gc::HRC</a>, <a class="el" href="classcds_1_1gc_1_1_p_t_b.html" title="Pass-the-Buck garbage collector.">cds::gc::PTB</a>) are applied analogously.</p>
<p>First, in your code you should initialize <code>cds</code> library and a garbage collector in <code>main</code> function: </p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;cds/init.h&gt;</span>       <span class="comment">// for cds::Initialize and cds::Terminate</span></div>
<div class="line"><span class="preprocessor">#include &lt;cds/gc/hp.h&gt;</span>      <span class="comment">// for cds::HP (Hazard Pointer) garbage collector</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Initialize libcds</span></div>
<div class="line">    <a class="code" href="namespacecds.html#ae14cc7bb67e75ea6ed18a82f3380d2c0" title="Initialize CDS library.">cds::Initialize</a>() ;</div>
<div class="line"></div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Initialize Hazard Pointer singleton</span></div>
<div class="line">        cds::gc::HP hpGC ;</div>
<div class="line"></div>
<div class="line">        <span class="comment">// If main thread uses lock-free containers</span></div>
<div class="line">        <span class="comment">// the main thread should be attached to libcds infrastructure</span></div>
<div class="line">        <a class="code" href="classcds_1_1gc_1_1_h_p_1_1thread__gc.html" title="Wrapper for hzp::ThreadGC class.">cds::gc::HP::thread_gc</a> myThreadGC    ;</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Do what you need</span></div>
<div class="line">        ...</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Terminate libcds</span></div>
<div class="line">    <a class="code" href="namespacecds.html#a9ca275d587d2b0b11ded25220718a049" title="Terminate CDS library.">cds::Terminate</a>()    ;</div>
<div class="line">}</div>
</div><!-- fragment --><p>Second, any of your thread should be attached to <code>cds</code> infrastructure. </p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;cds/gc/hp.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> myThreadEntryPoint(<span class="keywordtype">void</span> *)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Attach the thread to Hazard Pointer singleton</span></div>
<div class="line">    <a class="code" href="classcds_1_1gc_1_1_h_p_1_1thread__gc.html" title="Wrapper for hzp::ThreadGC class.">cds::gc::HP::thread_gc</a> myThreadGC    ;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Do some work</span></div>
<div class="line">    ...</div>
<div class="line"></div>
<div class="line">    <span class="comment">// The destructor of myThreadGC object detaches the thread from HP singleton</span></div>
<div class="line">}</div>
</div><!-- fragment --><p>After that, you can use <code>cds</code> lock-free containers safely without any synchronization.</p>
<p>In some cases, you should work in a external thread. For example, your application is a plug-in for a server that calls your code in a thread that has been created by the server. In this case, you should use persistent mode of garbage collecting. In this mode, the thread attaches to the GC singleton only if it is not attached yet and never call detaching: </p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;cds/gc/hp.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> myThreadEntryPoint()</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Attach the thread in persistent mode</span></div>
<div class="line">    <a class="code" href="classcds_1_1gc_1_1_h_p_1_1thread__gc.html" title="Wrapper for hzp::ThreadGC class.">cds::gc::HP::thread_gc</a> myThreadGC( <span class="keyword">true</span> )    ;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Do some work</span></div>
<div class="line">    ...</div>
<div class="line"></div>
<div class="line">    <span class="comment">// The destructor of myThreadGC object does NOT detach the thread from HP singleton</span></div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- contents -->
		<hr/>
		<div align="right">
			<b>cds</b> <b>1.2.0</b> 
			Developed by <i>Maxim Khiszinsky aka khizmax</i> 2007 - 2012
			<br/>
			<i>Autogenerated Mon Aug 20 2012 22:32:43 by Doxygen 1.8.1.2</i>
		</div>
	</BODY>
</HTML>
